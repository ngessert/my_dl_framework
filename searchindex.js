Search.setIndex({"docnames": ["api/modules", "api/my_dl_framework", "api/my_dl_framework.data", "api/my_dl_framework.data.rsna_binary", "api/my_dl_framework.evaluation", "api/my_dl_framework.models", "api/my_dl_framework.training", "api/my_dl_framework.utils", "api/my_dl_framework.utils.pytorch_lightning", "evaluation", "index", "readme", "training"], "filenames": ["api/modules.rst", "api/my_dl_framework.rst", "api/my_dl_framework.data.rst", "api/my_dl_framework.data.rsna_binary.rst", "api/my_dl_framework.evaluation.rst", "api/my_dl_framework.models.rst", "api/my_dl_framework.training.rst", "api/my_dl_framework.utils.rst", "api/my_dl_framework.utils.pytorch_lightning.rst", "evaluation.rst", "index.rst", "readme.rst", "training.rst"], "titles": ["my_dl_framework", "my_dl_framework namespace", "my_dl_framework.data namespace", "my_dl_framework.data.rsna_binary namespace", "my_dl_framework.evaluation namespace", "my_dl_framework.models namespace", "my_dl_framework.training namespace", "my_dl_framework.utils namespace", "my_dl_framework.utils.pytorch_lightning namespace", "Evaluation and Ensemlbing", "My Dl Framework", "My Deep Learning Framework", "Training"], "terms": {"namespac": [0, 10], "subpackag": 0, "data": [0, 1, 4, 5, 9, 10], "submodul": [0, 1], "get_dataset": [0, 1], "modul": [0, 1, 10], "util": [0, 1, 5], "evalu": [0, 1, 2, 6, 10], "eval_and_predict": [0, 1, 9, 11], "model": [0, 1, 4, 6, 7, 8, 9, 11, 12], "pl_class_wrapp": [0, 1], "train": [0, 1, 2, 5, 8, 9, 10], "train_pl": [0, 1, 11, 12], "train_remot": [0, 1], "explore_data": [0, 1], "parse_str": [0, 1], "test_inf_tim": [0, 1], "rsna_binari": [1, 2], "define_cv_split_rsnachalleng": [1, 2, 11, 12], "rsna_binary_dataset": [1, 2], "addbatchdim": [1, 2], "fliptta": [1, 2], "multiequalcrop": [1, 2], "zeroonenorm": [1, 2], "collate_aug_batch": [1, 2], "load_any_imag": [1, 2], "run_predict": [1, 4], "calculate_metr": [1, 4], "get_confusion_matrix": [1, 4], "get_roc_curv": [1, 4], "validate_model_classif": [1, 4], "plclassificationwrapp": [1, 5], "calc_and_log_metr": [1, 5], "configure_optim": [1, 5], "forward": [1, 5], "training_step": [1, 5], "training_step_end": [1, 5], "validation_epoch_end": [1, 5], "validation_step": [1, 5], "validation_step_end": [1, 5], "stack_list_of_dict": [1, 5], "run_train": [1, 6], "numpyencod": [1, 6], "default": [1, 5, 6, 11, 12], "get_and_log_metrics_classif": [1, 6], "get_lossfunct": [1, 6], "get_lr_schedul": [1, 6], "get_optim": [1, 6], "get_tv_class_model": [1, 6], "plot_example_batch": [1, 6], "pytorch_lightn": [1, 5, 7], "clearml_logg": [1, 7], "minibatch_plot_callback": [1, 7], "tput": [1, 7], "main": [2, 3, 6], "rsnachallengebinarydataset": [2, 3], "gener": [2, 3, 5, 8, 11, 12], "dataset": [2, 3, 5, 9, 11], "getter": 2, "config": [2, 3, 4, 5, 6, 8, 9, 10], "dict": [2, 3, 4, 5, 6, 8], "image_dir": [2, 3], "str": [2, 3, 4, 5, 6, 7, 8], "path_to_label_csv": [2, 3], "none": [2, 3, 4, 5, 6, 7, 8], "subset": [2, 3, 5, 9, 11], "list": [2, 3, 4, 5, 6, 7, 8], "tta_opt": [2, 3], "is_train": [2, 3], "bool": [2, 3, 4, 5, 6, 7, 8], "sourc": [2, 3, 4, 5, 6, 7, 8, 11, 12], "torch": [2, 4, 5, 6], "param": [2, 4, 5, 6, 8], "path": [2, 6, 8], "where": [2, 6, 11], "imag": [2, 5, 6, 8, 11, 12], "ar": [2, 4, 5, 9, 11, 12], "locat": [2, 11, 12], "csv": [2, 9, 11, 12], "label": [2, 9, 11, 12], "select": 2, "tta": 2, "option": [2, 3, 4, 5, 6, 8, 9, 10, 11], "whether": [2, 6], "mode": [2, 5, 9, 11], "i": [2, 5, 6, 8, 9, 11], "activ": 2, "e": [2, 5, 6, 8, 9, 11, 12], "g": [2, 5, 6, 8, 9, 11, 12], "augment": [2, 9, 11], "return": [2, 4, 5, 6, 8], "A": [2, 5, 8, 10, 11], "class": [2, 3, 4, 5, 6, 8], "base": [2, 3, 5, 6, 8, 10, 11, 12], "object": [2, 5, 6, 8], "add": [2, 5, 9, 11], "batch": [2, 4, 5, 6, 8, 11], "dim": [2, 5], "flip_axi": 2, "int": [2, 3, 4, 5, 6, 7, 8], "flip": [2, 9, 11], "expect": 2, "present": [2, 5], "num_per_axi": 2, "crop_siz": 2, "multi": [2, 5], "crop": 2, "being": [2, 5, 6, 8], "equal": 2, "distribut": 2, "over": [2, 5], "0": [2, 5], "1": [2, 5, 8], "norm": 2, "tensor": [2, 5, 6], "collat": 2, "an": [2, 5, 6, 8, 9, 11, 12], "when": [2, 5, 8], "multipl": [2, 5, 8, 9, 11, 12], "onc": 2, "paramet": [2, 5, 8], "uncol": 2, "image_path": [2, 4, 9, 11], "ndarrai": [2, 4, 5, 6], "loader": 2, "differ": [2, 5], "type": [2, 7], "current": [2, 5], "support": [2, 5, 6, 11], "dcm": 2, "load": [2, 8], "The": [2, 5, 8, 9, 11, 12], "numpi": [2, 4, 5, 6], "arrai": [2, 4], "cv": [3, 9, 11, 12], "split": [3, 9, 11, 12], "script": [3, 4, 6], "rsna": [3, 11, 12], "challeng": [3, 11, 12], "usag": [3, 6], "py": [3, 4, 6, 9, 11, 12], "h": 3, "num_cv": [3, 11, 12], "save_path": [3, 6, 11, 12], "help": 3, "displai": [3, 5], "number": [3, 4, 5, 6, 8], "file": [3, 6, 9, 11, 12], "json": [3, 6, 11, 12], "contain": [3, 5, 8, 9, 11, 12], "defin": [3, 5, 11, 12], "exampl": [3, 4, 5, 6], "python": [3, 4, 6, 9, 11, 12], "my_dl_frameworkdatadefine_cv_split_rsnachalleng": 3, "3": [3, 5, 11, 12], "c": [3, 4, 6, 9, 11, 12], "sourcesmy_dl_frameworkcv_splitscv_split_3fold": 3, "allow_missing_target": 3, "fals": [3, 5, 6], "classif": [3, 4, 5, 6, 11], "task": [3, 8, 11], "predict": [4, 5, 6, 9, 11], "work": [4, 12], "without": [4, 5], "target": [4, 5, 6], "If": [4, 5, 11, 12], "get": [4, 5, 6, 8, 10], "metric": [4, 5, 6, 8, 9, 11], "well": 4, "folder": [4, 9, 11, 12], "run": [4, 5, 6, 9, 11, 12], "cl": [4, 6, 9, 11, 12], "clearml": [4, 6, 7, 9, 10, 11], "us": [4, 5, 6, 8, 9, 11, 12], "my_dl_frameworkevaluationeval_and_predict": 4, "datarsna_challengeexperimentstest_config": 4, "yaml20": 4, "02": [4, 5], "2022": 4, "20": 4, "38": 4, "12": 4, "clearml_id": 4, "remot": [4, 6, 10], "eval_on_train": 4, "cv_eval": [4, 9, 11], "limit_batch": 4, "dont_log_split": 4, "label_csv_path": [4, 9, 11], "tta_flip_horz": [4, 9, 11], "tta_flip_vert": [4, 9, 11], "tta_multi_eq_crop": 4, "class_nam": 4, "tupl": [4, 5, 6], "calcul": [4, 5], "from": [4, 5, 6, 8, 9, 11], "bxc": 4, "b": 4, "conf_matrix": 4, "figur": 4, "creat": [4, 9, 11, 12], "confus": 4, "matrix": 4, "plotli": [4, 8], "pot": 4, "name": [4, 5, 6, 7, 8, 11, 12], "roc": 4, "curv": 4, "auc": 4, "score": 4, "2d": 4, "1d": 4, "dataload": [4, 5, 6], "max_num_batch": 4, "use_cleaml": 4, "true": [4, 5, 6, 8], "valid": [4, 5, 8, 11, 12], "maximum": 4, "plot": [4, 6], "training_set_len": 5, "is_trainv": 5, "prefix": 5, "lightningmodul": [5, 8], "pytorch": [5, 6, 8, 10, 11], "lightn": [5, 6, 8, 10, 11], "wrapper": 5, "eval_nam": [5, 6], "step": [5, 8], "logger": [5, 6, 7], "choos": 5, "what": [5, 11], "optim": [5, 6], "learn": [5, 6, 10], "rate": [5, 6], "schedul": [5, 6, 11, 12], "your": [5, 11, 12], "normal": 5, "you": [5, 6, 9, 11, 12], "d": 5, "need": [5, 8, 12], "one": [5, 8, 11, 12], "But": 5, "case": [5, 9, 11], "gan": 5, "similar": 5, "might": 5, "have": 5, "ani": [5, 8, 11, 12], "6": 5, "singl": [5, 12], "two": 5, "first": [5, 12], "ha": [5, 8], "second": 5, "lr": 5, "lr_scheduler_config": 5, "dictionari": [5, 8], "kei": [5, 8], "lr_schedul": [5, 6], "whose": 5, "valu": [5, 8], "describ": 5, "abov": 5, "frequenc": 5, "fit": 5, "which": [5, 8], "its": [5, 9, 11], "associ": 5, "configur": 5, "shown": 5, "below": 5, "requir": [5, 11], "instanc": [5, 8], "unit": [5, 11], "": [5, 8, 11], "size": 5, "could": [5, 6], "also": [5, 9, 11, 12], "epoch": [5, 6], "updat": [5, 11, 12], "end": 5, "wherea": 5, "after": [5, 8, 11], "interv": 5, "how": 5, "mani": [5, 11], "should": [5, 8, 11, 12], "pass": [5, 6], "between": 5, "call": [5, 6, 8], "correspond": 5, "everi": 5, "monitor": 5, "like": [5, 6], "reducelronplateau": 5, "val_loss": 5, "set": [5, 6, 11, 12], "enforc": 5, "specifi": 5, "avail": [5, 9, 11, 12], "thu": 5, "stop": 5, "found": [5, 11], "onli": [5, 11], "produc": 5, "warn": 5, "strict": 5, "learningratemonitor": 5, "callback": [5, 8], "progress": 5, "thi": [5, 6, 8, 11, 12], "keyword": [5, 8], "can": [5, 9, 11, 12], "custom": 5, "log": [5, 6, 8, 9, 11, 12], "method": [5, 6, 8], "condit": 5, "def": [5, 6], "self": [5, 6], "adam": 5, "metric_to_track": 5, "indic": 5, "often": 5, "refer": [5, 10], "trainer": [5, 8], "check_val_every_n_epoch": 5, "In": [5, 9], "optimizer1": 5, "optimizer2": 5, "sgd": 5, "scheduler1": 5, "scheduler2": 5, "lambdalr": 5, "made": 5, "simpli": 5, "metric_v": 5, "along": 5, "sequenti": 5, "specif": [5, 8], "It": [5, 11], "given": [5, 8], "all": [5, 9, 11], "There": [5, 9, 11], "former": [5, 9, 11], "oper": 5, "each": [5, 9, 11], "latter": [5, 9, 11], "mention": 5, "optimizer_on": 5, "01": 5, "optimizer_two": 5, "5": 5, "10": 5, "next": [5, 11, 12], "cycl": 5, "continu": 5, "most": 5, "1e": 5, "gen_opt": 5, "model_gen": 5, "dis_opt": 5, "model_di": 5, "dis_sch": 5, "cosineann": 5, "t_max": 5, "own": 5, "gen_sch": 5, "exponentiallr": 5, "99": 5, "see": 5, "procedur": 5, "improv": 5, "wasserstein": 5, "algorithm": 5, "http": [5, 11, 12], "arxiv": 5, "org": 5, "ab": 5, "1704": 5, "00028": 5, "n_critic": 5, "some": [5, 6], "thing": [5, 11], "know": 5, "backward": 5, "automat": 5, "16": 5, "bit": 5, "precis": 5, "handl": 5, "addit": [5, 9], "optimizer_idx": 5, "lbfg": 5, "closur": 5, "function": [5, 6], "gradient": 5, "control": 5, "those": 5, "overrid": 5, "optimizer_step": 5, "hook": 5, "x": [5, 11], "same": 5, "nn": 5, "arg": [5, 8], "whatev": 5, "decid": 5, "kwarg": [5, 8], "argument": [5, 8], "possibl": 5, "output": [5, 6], "train_batch": 5, "batch_idx": [5, 8], "here": [5, 11], "comput": [5, 12], "loss": [5, 6], "bar": 5, "integ": 5, "index": 5, "hidden": 5, "paramref": 5, "core": 5, "truncated_bptt_step": 5, "includ": 5, "must": 5, "skip": [5, 11], "gpu": [5, 6], "tpu": 5, "ipu": 5, "deepspe": 5, "do": [5, 8, 11, 12], "fancier": 5, "someth": 5, "y": 5, "z": 5, "out": 5, "encod": [5, 6], "decod": 5, "truncat": 5, "back": 5, "propag": 5, "through": 5, "time": [5, 9, 11], "state": [5, 8], "previou": 5, "backprop": 5, "lstm": 5, "smooth": 5, "averag": [5, 9, 11], "last": 5, "so": 5, "actual": 5, "accumulate_grad_batch": 5, "intern": 5, "step_output": 5, "dp": 5, "becaus": 5, "part": 5, "howev": [5, 9, 11], "still": 5, "softmax": 5, "nce": 5, "later": 5, "switch": 5, "ddp": 5, "other": [5, 11], "don": 5, "t": 5, "chang": 5, "code": [5, 11], "pseudocod": 5, "sub_batch": 5, "split_batches_for_dp": 5, "anyth": 5, "strategi": 5, "portion": 5, "insid": 5, "num_gpu": [5, 6], "big": 5, "denomin": 5, "nce_loss": 5, "wish": 5, "pred": 5, "training_step_output": 5, "gpu_0_pr": 5, "gpu_1_pr": 5, "gpu_n_pr": 5, "n": 5, "now": 5, "full": 5, "guid": 5, "more": [5, 9, 11], "detail": [5, 12], "val_out": 5, "val_batch": 5, "val_data": 5, "append": 5, "didn": 5, "won": 5, "With": 5, "val_step_output": 5, "outer": 5, "entri": 5, "per": 5, "while": 5, "inner": 5, "individu": 5, "dataloader_output_result": 5, "dataloader_out": 5, "dataloader_i_output": 5, "final_metr": 5, "final_valu": 5, "dataloader_idx": [5, 8], "interest": 5, "accuraci": 5, "val": [5, 11, 12], "order": 5, "implement": [5, 6, 8], "text": [5, 8], "sample_img": 5, "grid": 5, "torchvis": [5, 6], "make_grid": 5, "experi": [5, 8, 9, 11, 12], "add_imag": 5, "example_imag": 5, "acc": 5, "labels_hat": 5, "argmax": 5, "val_acc": 5, "sum": 5, "item": 5, "len": 5, "log_dict": 5, "we": [5, 11, 12], "recommend": [5, 11], "quickli": 5, "2": [5, 8], "tell": 5, "been": 5, "put": 5, "eval": 5, "disabl": 5, "At": 5, "goe": 5, "enabl": 5, "larg": 5, "list_of_dict": 5, "to_numpi": 5, "take": 5, "concaten": [5, 9, 11], "them": [5, 8], "convert": 5, "ye": 5, "new": [5, 8, 9, 11], "stack": 5, "rubric": 6, "my_dl_frameworktrainingtrain_pl": 6, "sourcesmy_dl_frameworkconfigstest_config": 6, "yaml": [6, 11, 12], "config_path": 6, "multi_gpu_strat": 6, "fast_dev_run": 6, "whther": 6, "strat": 6, "dpp": 6, "job": [6, 9, 11, 12], "execut": [6, 10], "auto": 6, "lighn": 6, "dev": 6, "my_dl_frameworktrainingtrain_remot": 6, "cmd_arg": 6, "enqu": 6, "queue": [6, 11, 12], "stuff": 6, "skipkei": 6, "ensure_ascii": 6, "check_circular": 6, "allow_nan": 6, "sort_kei": 6, "indent": 6, "separ": 6, "jsonencod": 6, "save": [6, 8], "o": 6, "subclass": 6, "serializ": 6, "rais": 6, "typeerror": 6, "For": [6, 9, 11], "arbitrari": 6, "iter": 6, "try": 6, "except": 6, "els": 6, "let": 6, "curr_subfold": 6, "use_clearml": 6, "disk": 6, "test": [6, 9, 11], "draw": 6, "sampl": 6, "subfold": [6, 9, 11], "store": [6, 8, 11], "local": [6, 9, 11, 12], "loss_funct": 6, "replac": 6, "layer": 6, "idx": 6, "plclearml": [7, 8], "logger_join_char": [7, 8], "after_save_checkpoint": [7, 8], "download_artifact": [7, 8], "final": [7, 8], "log_hyperparam": [7, 8], "log_imag": [7, 8], "log_metr": [7, 8], "log_plotli": [7, 8], "log_tabl": [7, 8], "log_text": [7, 8], "save_dir": [7, 8], "version": [7, 8, 11], "mbplotcallback": [7, 8], "load_state_dict": [7, 8], "on_train_batch_start": [7, 8], "on_validation_batch_start": [7, 8], "state_dict": [7, 8], "state_kei": [7, 8], "helper": 7, "pars": 7, "string": 7, "extract": 7, "origin": [7, 9, 11], "orig_str": 7, "float": [7, 8], "name_bas": 8, "title_prefix": 8, "log_model": 8, "checkpoint_callback": 8, "modelcheckpoint": 8, "checkpoint": [8, 9, 11], "artifact": [8, 11], "download": [8, 9, 11, 12], "server": 8, "directori": [8, 11, 12], "statu": 8, "process": 8, "necessari": 8, "finish": 8, "success": 8, "fail": 8, "abort": 8, "record": 8, "hyperparamet": 8, "posit": 8, "depend": 8, "titl": 8, "map": 8, "soon": 8, "receiv": 8, "measur": 8, "quantiti": 8, "plotly_obj_dict": 8, "datafram": 8, "panda": 8, "tabl": 8, "messag": [8, 11], "properti": 8, "curr_subfolder_cv": 8, "reload": 8, "pl_modul": 8, "begin": 8, "identifi": 8, "retriev": 8, "provid": [8, 9, 11, 12], "uniqu": 8, "desir": 8, "maintain": 8, "afer": [9, 11], "either": [9, 11], "id": [9, 11], "etc": [9, 11], "my_dl_framework": [9, 10, 11, 12], "training1": [9, 11], "training_imag": [9, 11, 12], "appli": [9, 11], "respect": [9, 11], "togeth": [9, 11], "across": [9, 11], "fold": [9, 11], "flag": [9, 11], "meant": [9, 11], "unlabel": [9, 11], "label_fil": [9, 11], "arbitrarili": [9, 11], "combin": [9, 11], "ensembl": [9, 10], "todo": [9, 11, 12], "deep": 10, "overview": [10, 12], "start": 10, "prepar": 10, "worker": [10, 11], "purpos": 11, "repo": [11, 12], "tool": 11, "focus": 11, "scenario": 11, "goal": 11, "compon": 11, "inspir": 11, "win": 11, "isic": 11, "wip": 11, "would": 11, "contribut": 11, "open": 11, "issu": 11, "pr": 11, "me": 11, "featur": 11, "track": [11, 12], "power": 11, "mlop": 11, "system": 11, "pneumonia": 11, "chest": 11, "rai": 11, "binari": 11, "plan": 11, "segment": 11, "bound": 11, "box": 11, "detect": 11, "skin": 11, "lesion": 11, "document": 11, "regress": 11, "github": 11, "com": 11, "ngessert": 11, "clone": 11, "via": 11, "ssh": 11, "git": 11, "fork": 11, "sync": 11, "setup": 11, "environ": 11, "virtual": 11, "env": 11, "miniforg": 11, "9": 11, "Then": [11, 12], "instal": 11, "packag": 11, "pip": 11, "r": 11, "txt": 11, "develop": 11, "place": [11, 12], "rsna_challeng": [11, 12], "stage_2_train_label": [11, 12], "cross": [11, 12], "cv_splitscv_split_3fold": [11, 12], "cv_split_3fold": [11, 12], "treat": [11, 12], "even": [11, 12], "just": [11, 12], "want": [11, 12], "simpl": [11, 12], "ensur": [11, 12], "guarante": [11, 12], "reproduc": [11, 12], "copi": [11, 12], "test_config": [11, 12], "base_path": [11, 12], "csv_name": [11, 12], "training_image_dir": [11, 12], "data_split_fil": [11, 12], "explain": 11, "up": [11, 12], "account": [11, 12], "clear": [11, 12], "ml": [11, 12], "app": [11, 12], "credenti": [11, 12], "go": [11, 12], "workspac": [11, 12], "conf": [11, 12], "root": [11, 12], "machin": [11, 12], "home": [11, 12], "pleas": 11, "check": 11, "limit": 11, "intermedi": 11, "section": 12, "correct": 12, "structur": 12, "follow": 12, "make": 12, "sens": 12, "write": 12, "descript": 12}, "objects": {"": [[1, 0, 0, "-", "my_dl_framework"]], "my_dl_framework": [[2, 0, 0, "-", "data"], [4, 0, 0, "-", "evaluation"], [5, 0, 0, "-", "models"], [6, 0, 0, "-", "training"], [7, 0, 0, "-", "utils"]], "my_dl_framework.data": [[2, 0, 0, "-", "get_dataset"], [3, 0, 0, "-", "rsna_binary"], [2, 0, 0, "-", "utils"]], "my_dl_framework.data.get_dataset": [[2, 1, 1, "", "get_dataset"]], "my_dl_framework.data.rsna_binary": [[3, 0, 0, "-", "define_cv_split_rsnachallenge"], [3, 0, 0, "-", "rsna_binary_dataset"]], "my_dl_framework.data.rsna_binary.define_cv_split_rsnachallenge": [[3, 1, 1, "", "main"]], "my_dl_framework.data.rsna_binary.rsna_binary_dataset": [[3, 2, 1, "", "RSNAChallengeBinaryDataset"]], "my_dl_framework.data.utils": [[2, 2, 1, "", "AddBatchDim"], [2, 2, 1, "", "FlipTTA"], [2, 2, 1, "", "MultiEqualCrop"], [2, 2, 1, "", "ZeroOneNorm"], [2, 1, 1, "", "collate_aug_batch"], [2, 1, 1, "", "load_any_image"]], "my_dl_framework.evaluation": [[4, 0, 0, "-", "eval_and_predict"], [4, 0, 0, "-", "utils"]], "my_dl_framework.evaluation.eval_and_predict": [[4, 1, 1, "", "run_prediction"]], "my_dl_framework.evaluation.utils": [[4, 1, 1, "", "calculate_metrics"], [4, 1, 1, "", "get_confusion_matrix"], [4, 1, 1, "", "get_roc_curve"], [4, 1, 1, "", "validate_model_classification"]], "my_dl_framework.models": [[5, 0, 0, "-", "pl_class_wrapper"]], "my_dl_framework.models.pl_class_wrapper": [[5, 2, 1, "", "PLClassificationWrapper"], [5, 1, 1, "", "stack_list_of_dicts"]], "my_dl_framework.models.pl_class_wrapper.PLClassificationWrapper": [[5, 3, 1, "", "calc_and_log_metrics"], [5, 3, 1, "", "configure_optimizers"], [5, 3, 1, "", "forward"], [5, 4, 1, "", "training"], [5, 3, 1, "", "training_step"], [5, 3, 1, "", "training_step_end"], [5, 3, 1, "", "validation_epoch_end"], [5, 3, 1, "", "validation_step"], [5, 3, 1, "", "validation_step_end"]], "my_dl_framework.training": [[6, 0, 0, "-", "train_pl"], [6, 0, 0, "-", "train_remote"], [6, 0, 0, "-", "utils"]], "my_dl_framework.training.train_pl": [[6, 1, 1, "", "run_training"]], "my_dl_framework.training.train_remote": [[6, 1, 1, "", "train_remote"]], "my_dl_framework.training.utils": [[6, 2, 1, "", "NumpyEncoder"], [6, 1, 1, "", "get_and_log_metrics_classification"], [6, 1, 1, "", "get_lossfunction"], [6, 1, 1, "", "get_lr_scheduler"], [6, 1, 1, "", "get_optimizer"], [6, 1, 1, "", "get_tv_class_model"], [6, 1, 1, "", "plot_example_batch"]], "my_dl_framework.training.utils.NumpyEncoder": [[6, 3, 1, "", "default"]], "my_dl_framework.utils": [[7, 0, 0, "-", "parse_str"], [8, 0, 0, "-", "pytorch_lightning"], [7, 0, 0, "-", "test_inf_times"]], "my_dl_framework.utils.parse_str": [[7, 1, 1, "", "parse_str"]], "my_dl_framework.utils.pytorch_lightning": [[8, 0, 0, "-", "clearml_logger"], [8, 0, 0, "-", "minibatch_plot_callback"]], "my_dl_framework.utils.pytorch_lightning.clearml_logger": [[8, 2, 1, "", "PLClearML"]], "my_dl_framework.utils.pytorch_lightning.clearml_logger.PLClearML": [[8, 4, 1, "", "LOGGER_JOIN_CHAR"], [8, 3, 1, "", "after_save_checkpoint"], [8, 3, 1, "", "download_artifact"], [8, 3, 1, "", "finalize"], [8, 3, 1, "", "log_hyperparams"], [8, 3, 1, "", "log_image"], [8, 3, 1, "", "log_metrics"], [8, 3, 1, "", "log_plotly"], [8, 3, 1, "", "log_table"], [8, 3, 1, "", "log_text"], [8, 5, 1, "", "name"], [8, 5, 1, "", "save_dir"], [8, 5, 1, "", "version"]], "my_dl_framework.utils.pytorch_lightning.minibatch_plot_callback": [[8, 2, 1, "", "MBPlotCallback"]], "my_dl_framework.utils.pytorch_lightning.minibatch_plot_callback.MBPlotCallback": [[8, 3, 1, "", "load_state_dict"], [8, 3, 1, "", "on_train_batch_start"], [8, 3, 1, "", "on_validation_batch_start"], [8, 3, 1, "", "state_dict"], [8, 5, 1, "", "state_key"]], "my_dl_framework.utils.test_inf_times": [[7, 1, 1, "", "tput"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:method", "4": "py:attribute", "5": "py:property"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "method", "Python method"], "4": ["py", "attribute", "Python attribute"], "5": ["py", "property", "Python property"]}, "titleterms": {"my_dl_framework": [0, 1, 2, 3, 4, 5, 6, 7, 8], "namespac": [1, 2, 3, 4, 5, 6, 7, 8], "subpackag": [1, 2, 7], "data": [2, 3, 11, 12], "submodul": [2, 3, 4, 5, 6, 7, 8], "get_dataset": 2, "modul": [2, 3, 4, 5, 6, 7, 8], "util": [2, 4, 6, 7, 8], "rsna_binari": 3, "define_cv_split_rsnachalleng": 3, "rsna_binary_dataset": 3, "evalu": [4, 9, 11], "eval_and_predict": 4, "model": 5, "pl_class_wrapp": 5, "train": [6, 11, 12], "train_pl": 6, "train_remot": 6, "explore_data": 7, "parse_str": 7, "test_inf_tim": 7, "pytorch_lightn": 8, "clearml_logg": 8, "clearml": [8, 12], "logger": 8, "minibatch_plot_callback": 8, "ensemlb": 9, "my": [10, 11], "dl": 10, "framework": [10, 11], "content": 10, "deep": 11, "learn": 11, "get": 11, "start": 11, "prepar": [11, 12], "config": [11, 12], "ensembl": 11, "execut": 12, "option": 12, "remot": 12, "worker": 12}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"my_dl_framework": [[0, "my-dl-framework"]], "my_dl_framework namespace": [[1, "module-my_dl_framework"]], "Subpackages": [[1, "subpackages"], [2, "subpackages"], [7, "subpackages"]], "my_dl_framework.data namespace": [[2, "module-my_dl_framework.data"]], "Submodules": [[2, "submodules"], [3, "submodules"], [4, "submodules"], [5, "submodules"], [6, "submodules"], [7, "submodules"], [8, "submodules"]], "my_dl_framework.data.get_dataset module": [[2, "module-my_dl_framework.data.get_dataset"]], "my_dl_framework.data.utils module": [[2, "module-my_dl_framework.data.utils"]], "my_dl_framework.data.rsna_binary namespace": [[3, "module-my_dl_framework.data.rsna_binary"]], "my_dl_framework.data.rsna_binary.define_cv_split_rsnachallenge module": [[3, "module-my_dl_framework.data.rsna_binary.define_cv_split_rsnachallenge"]], "my_dl_framework.data.rsna_binary.rsna_binary_dataset module": [[3, "module-my_dl_framework.data.rsna_binary.rsna_binary_dataset"]], "my_dl_framework.evaluation namespace": [[4, "module-my_dl_framework.evaluation"]], "my_dl_framework.evaluation.eval_and_predict module": [[4, "module-my_dl_framework.evaluation.eval_and_predict"]], "my_dl_framework.evaluation.utils module": [[4, "module-my_dl_framework.evaluation.utils"]], "my_dl_framework.models namespace": [[5, "module-my_dl_framework.models"]], "my_dl_framework.models.pl_class_wrapper module": [[5, "module-my_dl_framework.models.pl_class_wrapper"]], "my_dl_framework.training namespace": [[6, "module-my_dl_framework.training"]], "my_dl_framework.training.train_pl module": [[6, "module-my_dl_framework.training.train_pl"]], "my_dl_framework.training.train_remote module": [[6, "module-my_dl_framework.training.train_remote"]], "my_dl_framework.training.utils module": [[6, "module-my_dl_framework.training.utils"]], "my_dl_framework.utils namespace": [[7, "module-my_dl_framework.utils"]], "my_dl_framework.utils.explore_data module": [[7, "my-dl-framework-utils-explore-data-module"]], "my_dl_framework.utils.parse_str module": [[7, "module-my_dl_framework.utils.parse_str"]], "my_dl_framework.utils.test_inf_times module": [[7, "module-my_dl_framework.utils.test_inf_times"]], "my_dl_framework.utils.pytorch_lightning namespace": [[8, "module-my_dl_framework.utils.pytorch_lightning"]], "my_dl_framework.utils.pytorch_lightning.clearml_logger module": [[8, "module-my_dl_framework.utils.pytorch_lightning.clearml_logger"]], "ClearML Logger": [[8, "clearml-logger"]], "my_dl_framework.utils.pytorch_lightning.minibatch_plot_callback module": [[8, "module-my_dl_framework.utils.pytorch_lightning.minibatch_plot_callback"]], "Evaluation and Ensemlbing": [[9, "evaluation-and-ensemlbing"]], "My Dl Framework": [[10, "my-dl-framework"]], "Content": [[10, "content"]], "My Deep Learning Framework": [[11, "my-deep-learning-framework"]], "Getting Started": [[11, "getting-started"]], "Prepare Data and Config": [[11, "prepare-data-and-config"], [12, "prepare-data-and-config"]], "Training": [[11, "training"], [12, "training"]], "Evaluation": [[11, "evaluation"]], "Ensembling": [[11, "ensembling"]], "Execute the Training": [[12, "execute-the-training"]], "Config Options": [[12, "config-options"]], "Remote Training and ClearML Workers": [[12, "remote-training-and-clearml-workers"]]}, "indexentries": {"module": [[1, "module-my_dl_framework"], [2, "module-my_dl_framework.data"], [2, "module-my_dl_framework.data.get_dataset"], [2, "module-my_dl_framework.data.utils"], [3, "module-my_dl_framework.data.rsna_binary"], [3, "module-my_dl_framework.data.rsna_binary.define_cv_split_rsnachallenge"], [3, "module-my_dl_framework.data.rsna_binary.rsna_binary_dataset"], [4, "module-my_dl_framework.evaluation"], [4, "module-my_dl_framework.evaluation.eval_and_predict"], [4, "module-my_dl_framework.evaluation.utils"], [5, "module-my_dl_framework.models"], [5, "module-my_dl_framework.models.pl_class_wrapper"], [6, "module-my_dl_framework.training"], [6, "module-my_dl_framework.training.train_pl"], [6, "module-my_dl_framework.training.train_remote"], [6, "module-my_dl_framework.training.utils"], [7, "module-my_dl_framework.utils"], [7, "module-my_dl_framework.utils.parse_str"], [7, "module-my_dl_framework.utils.test_inf_times"], [8, "module-my_dl_framework.utils.pytorch_lightning"], [8, "module-my_dl_framework.utils.pytorch_lightning.clearml_logger"], [8, "module-my_dl_framework.utils.pytorch_lightning.minibatch_plot_callback"]], "my_dl_framework": [[1, "module-my_dl_framework"]], "addbatchdim (class in my_dl_framework.data.utils)": [[2, "my_dl_framework.data.utils.AddBatchDim"]], "fliptta (class in my_dl_framework.data.utils)": [[2, "my_dl_framework.data.utils.FlipTTA"]], "multiequalcrop (class in my_dl_framework.data.utils)": [[2, "my_dl_framework.data.utils.MultiEqualCrop"]], "zeroonenorm (class in my_dl_framework.data.utils)": [[2, "my_dl_framework.data.utils.ZeroOneNorm"]], "collate_aug_batch() (in module my_dl_framework.data.utils)": [[2, "my_dl_framework.data.utils.collate_aug_batch"]], "get_dataset() (in module my_dl_framework.data.get_dataset)": [[2, "my_dl_framework.data.get_dataset.get_dataset"]], "load_any_image() (in module my_dl_framework.data.utils)": [[2, "my_dl_framework.data.utils.load_any_image"]], "my_dl_framework.data": [[2, "module-my_dl_framework.data"]], "my_dl_framework.data.get_dataset": [[2, "module-my_dl_framework.data.get_dataset"]], "my_dl_framework.data.utils": [[2, "module-my_dl_framework.data.utils"]], "rsnachallengebinarydataset (class in my_dl_framework.data.rsna_binary.rsna_binary_dataset)": [[3, "my_dl_framework.data.rsna_binary.rsna_binary_dataset.RSNAChallengeBinaryDataset"]], "main() (in module my_dl_framework.data.rsna_binary.define_cv_split_rsnachallenge)": [[3, "my_dl_framework.data.rsna_binary.define_cv_split_rsnachallenge.main"]], "my_dl_framework.data.rsna_binary": [[3, "module-my_dl_framework.data.rsna_binary"]], "my_dl_framework.data.rsna_binary.define_cv_split_rsnachallenge": [[3, "module-my_dl_framework.data.rsna_binary.define_cv_split_rsnachallenge"]], "my_dl_framework.data.rsna_binary.rsna_binary_dataset": [[3, "module-my_dl_framework.data.rsna_binary.rsna_binary_dataset"]], "calculate_metrics() (in module my_dl_framework.evaluation.utils)": [[4, "my_dl_framework.evaluation.utils.calculate_metrics"]], "get_confusion_matrix() (in module my_dl_framework.evaluation.utils)": [[4, "my_dl_framework.evaluation.utils.get_confusion_matrix"]], "get_roc_curve() (in module my_dl_framework.evaluation.utils)": [[4, "my_dl_framework.evaluation.utils.get_roc_curve"]], "my_dl_framework.evaluation": [[4, "module-my_dl_framework.evaluation"]], "my_dl_framework.evaluation.eval_and_predict": [[4, "module-my_dl_framework.evaluation.eval_and_predict"]], "my_dl_framework.evaluation.utils": [[4, "module-my_dl_framework.evaluation.utils"]], "run_prediction() (in module my_dl_framework.evaluation.eval_and_predict)": [[4, "my_dl_framework.evaluation.eval_and_predict.run_prediction"]], "validate_model_classification() (in module my_dl_framework.evaluation.utils)": [[4, "my_dl_framework.evaluation.utils.validate_model_classification"]], "plclassificationwrapper (class in my_dl_framework.models.pl_class_wrapper)": [[5, "my_dl_framework.models.pl_class_wrapper.PLClassificationWrapper"]], "calc_and_log_metrics() (my_dl_framework.models.pl_class_wrapper.plclassificationwrapper method)": [[5, "my_dl_framework.models.pl_class_wrapper.PLClassificationWrapper.calc_and_log_metrics"]], "configure_optimizers() (my_dl_framework.models.pl_class_wrapper.plclassificationwrapper method)": [[5, "my_dl_framework.models.pl_class_wrapper.PLClassificationWrapper.configure_optimizers"]], "forward() (my_dl_framework.models.pl_class_wrapper.plclassificationwrapper method)": [[5, "my_dl_framework.models.pl_class_wrapper.PLClassificationWrapper.forward"]], "my_dl_framework.models": [[5, "module-my_dl_framework.models"]], "my_dl_framework.models.pl_class_wrapper": [[5, "module-my_dl_framework.models.pl_class_wrapper"]], "stack_list_of_dicts() (in module my_dl_framework.models.pl_class_wrapper)": [[5, "my_dl_framework.models.pl_class_wrapper.stack_list_of_dicts"]], "training (my_dl_framework.models.pl_class_wrapper.plclassificationwrapper attribute)": [[5, "my_dl_framework.models.pl_class_wrapper.PLClassificationWrapper.training"]], "training_step() (my_dl_framework.models.pl_class_wrapper.plclassificationwrapper method)": [[5, "my_dl_framework.models.pl_class_wrapper.PLClassificationWrapper.training_step"]], "training_step_end() (my_dl_framework.models.pl_class_wrapper.plclassificationwrapper method)": [[5, "my_dl_framework.models.pl_class_wrapper.PLClassificationWrapper.training_step_end"]], "validation_epoch_end() (my_dl_framework.models.pl_class_wrapper.plclassificationwrapper method)": [[5, "my_dl_framework.models.pl_class_wrapper.PLClassificationWrapper.validation_epoch_end"]], "validation_step() (my_dl_framework.models.pl_class_wrapper.plclassificationwrapper method)": [[5, "my_dl_framework.models.pl_class_wrapper.PLClassificationWrapper.validation_step"]], "validation_step_end() (my_dl_framework.models.pl_class_wrapper.plclassificationwrapper method)": [[5, "my_dl_framework.models.pl_class_wrapper.PLClassificationWrapper.validation_step_end"]], "numpyencoder (class in my_dl_framework.training.utils)": [[6, "my_dl_framework.training.utils.NumpyEncoder"]], "default() (my_dl_framework.training.utils.numpyencoder method)": [[6, "my_dl_framework.training.utils.NumpyEncoder.default"]], "get_and_log_metrics_classification() (in module my_dl_framework.training.utils)": [[6, "my_dl_framework.training.utils.get_and_log_metrics_classification"]], "get_lossfunction() (in module my_dl_framework.training.utils)": [[6, "my_dl_framework.training.utils.get_lossfunction"]], "get_lr_scheduler() (in module my_dl_framework.training.utils)": [[6, "my_dl_framework.training.utils.get_lr_scheduler"]], "get_optimizer() (in module my_dl_framework.training.utils)": [[6, "my_dl_framework.training.utils.get_optimizer"]], "get_tv_class_model() (in module my_dl_framework.training.utils)": [[6, "my_dl_framework.training.utils.get_tv_class_model"]], "my_dl_framework.training": [[6, "module-my_dl_framework.training"]], "my_dl_framework.training.train_pl": [[6, "module-my_dl_framework.training.train_pl"]], "my_dl_framework.training.train_remote": [[6, "module-my_dl_framework.training.train_remote"]], "my_dl_framework.training.utils": [[6, "module-my_dl_framework.training.utils"]], "plot_example_batch() (in module my_dl_framework.training.utils)": [[6, "my_dl_framework.training.utils.plot_example_batch"]], "run_training() (in module my_dl_framework.training.train_pl)": [[6, "my_dl_framework.training.train_pl.run_training"]], "train_remote() (in module my_dl_framework.training.train_remote)": [[6, "my_dl_framework.training.train_remote.train_remote"]], "my_dl_framework.utils": [[7, "module-my_dl_framework.utils"]], "my_dl_framework.utils.parse_str": [[7, "module-my_dl_framework.utils.parse_str"]], "my_dl_framework.utils.test_inf_times": [[7, "module-my_dl_framework.utils.test_inf_times"]], "parse_str() (in module my_dl_framework.utils.parse_str)": [[7, "my_dl_framework.utils.parse_str.parse_str"]], "tput() (in module my_dl_framework.utils.test_inf_times)": [[7, "my_dl_framework.utils.test_inf_times.tput"]], "logger_join_char (my_dl_framework.utils.pytorch_lightning.clearml_logger.plclearml attribute)": [[8, "my_dl_framework.utils.pytorch_lightning.clearml_logger.PLClearML.LOGGER_JOIN_CHAR"]], "mbplotcallback (class in my_dl_framework.utils.pytorch_lightning.minibatch_plot_callback)": [[8, "my_dl_framework.utils.pytorch_lightning.minibatch_plot_callback.MBPlotCallback"]], "plclearml (class in my_dl_framework.utils.pytorch_lightning.clearml_logger)": [[8, "my_dl_framework.utils.pytorch_lightning.clearml_logger.PLClearML"]], "after_save_checkpoint() (my_dl_framework.utils.pytorch_lightning.clearml_logger.plclearml method)": [[8, "my_dl_framework.utils.pytorch_lightning.clearml_logger.PLClearML.after_save_checkpoint"]], "download_artifact() (my_dl_framework.utils.pytorch_lightning.clearml_logger.plclearml method)": [[8, "my_dl_framework.utils.pytorch_lightning.clearml_logger.PLClearML.download_artifact"]], "finalize() (my_dl_framework.utils.pytorch_lightning.clearml_logger.plclearml method)": [[8, "my_dl_framework.utils.pytorch_lightning.clearml_logger.PLClearML.finalize"]], "load_state_dict() (my_dl_framework.utils.pytorch_lightning.minibatch_plot_callback.mbplotcallback method)": [[8, "my_dl_framework.utils.pytorch_lightning.minibatch_plot_callback.MBPlotCallback.load_state_dict"]], "log_hyperparams() (my_dl_framework.utils.pytorch_lightning.clearml_logger.plclearml method)": [[8, "my_dl_framework.utils.pytorch_lightning.clearml_logger.PLClearML.log_hyperparams"]], "log_image() (my_dl_framework.utils.pytorch_lightning.clearml_logger.plclearml method)": [[8, "my_dl_framework.utils.pytorch_lightning.clearml_logger.PLClearML.log_image"]], "log_metrics() (my_dl_framework.utils.pytorch_lightning.clearml_logger.plclearml method)": [[8, "my_dl_framework.utils.pytorch_lightning.clearml_logger.PLClearML.log_metrics"]], "log_plotly() (my_dl_framework.utils.pytorch_lightning.clearml_logger.plclearml method)": [[8, "my_dl_framework.utils.pytorch_lightning.clearml_logger.PLClearML.log_plotly"]], "log_table() (my_dl_framework.utils.pytorch_lightning.clearml_logger.plclearml method)": [[8, "my_dl_framework.utils.pytorch_lightning.clearml_logger.PLClearML.log_table"]], "log_text() (my_dl_framework.utils.pytorch_lightning.clearml_logger.plclearml method)": [[8, "my_dl_framework.utils.pytorch_lightning.clearml_logger.PLClearML.log_text"]], "my_dl_framework.utils.pytorch_lightning": [[8, "module-my_dl_framework.utils.pytorch_lightning"]], "my_dl_framework.utils.pytorch_lightning.clearml_logger": [[8, "module-my_dl_framework.utils.pytorch_lightning.clearml_logger"]], "my_dl_framework.utils.pytorch_lightning.minibatch_plot_callback": [[8, "module-my_dl_framework.utils.pytorch_lightning.minibatch_plot_callback"]], "name (my_dl_framework.utils.pytorch_lightning.clearml_logger.plclearml property)": [[8, "my_dl_framework.utils.pytorch_lightning.clearml_logger.PLClearML.name"]], "on_train_batch_start() (my_dl_framework.utils.pytorch_lightning.minibatch_plot_callback.mbplotcallback method)": [[8, "my_dl_framework.utils.pytorch_lightning.minibatch_plot_callback.MBPlotCallback.on_train_batch_start"]], "on_validation_batch_start() (my_dl_framework.utils.pytorch_lightning.minibatch_plot_callback.mbplotcallback method)": [[8, "my_dl_framework.utils.pytorch_lightning.minibatch_plot_callback.MBPlotCallback.on_validation_batch_start"]], "save_dir (my_dl_framework.utils.pytorch_lightning.clearml_logger.plclearml property)": [[8, "my_dl_framework.utils.pytorch_lightning.clearml_logger.PLClearML.save_dir"]], "state_dict() (my_dl_framework.utils.pytorch_lightning.minibatch_plot_callback.mbplotcallback method)": [[8, "my_dl_framework.utils.pytorch_lightning.minibatch_plot_callback.MBPlotCallback.state_dict"]], "state_key (my_dl_framework.utils.pytorch_lightning.minibatch_plot_callback.mbplotcallback property)": [[8, "my_dl_framework.utils.pytorch_lightning.minibatch_plot_callback.MBPlotCallback.state_key"]], "version (my_dl_framework.utils.pytorch_lightning.clearml_logger.plclearml property)": [[8, "my_dl_framework.utils.pytorch_lightning.clearml_logger.PLClearML.version"]]}})